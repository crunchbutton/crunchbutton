<div class="top-pad"></div>

<div class="content-padding" ng-show="ready">

	<h1 class="title left"><i class="fa fa-automobile"></i><span>Driver Onboarding</span></h1>

	<div class="divider"></div>


	<h2 class="title">
		<span ng-if="!driver.id_admin">Add driver</span>
		<span ng-if="driver.id_admin">Edit driver</span>
	</h2>

	<form name="form" novalidate>

		<ul ng-class="{'submitted':submitted}" class="ul-inputs">

			<li class="li-input" ng-class="{'error':form.driverName.$invalid}"> 
				<div class="label">Name:</div>
				<div class="input"><input type="text" name="driverName" ng-model="driver.name" required placeholder="Name" ng-minlength="5" ng-maxlength="40" ></div>
				<div class="box-error">
					<small ng-show="form.driverName.$error.required">Required.</small>
					<small ng-show="form.driverName.$error.minlength">Name is too short. Name is required to be at least 5 characters.</small>
					<small ng-show="form.driverName.$error.maxlength">Name cannot be longer than 40 characters.</small>
				</div>
			</li>

			<li class="li-input" ng-class="{'error':form.driverPhone.$invalid}"> 
				<div class="label">Phone:</div>
				<div class="input"><input type="text" name="driverPhone" ng-model="driver.phone" required phone-validate placeholder="Phone"></div>
				<div class="box-error">
					<small ng-show="form.driverPhone.$error.required">Required.</small>
					<small ng-show="form.driverPhone.$error.phoneValidate">Enter a valid phone.</small>
				</div>
			</li>

			<li class="li-input" ng-class="{'error':form.driverIdCommunity.$invalid}"> 
				<div class="label">Community:</div>
				<select name="driverIdCommunity" required ng-model="driver.id_community" ng-options="opt.id_community as opt.name for opt in communities" class="cart-customize-select"></select>
				<div class="box-error">
					<small ng-show="form.driverIdCommunity.$error.required">Required.</small>
				</div>
			</li>

			<li class="li-input" ng-class="{'error':form.driverEmail.$invalid}"> 
				<div class="label">Email:</div>
				<div class="input"><input type="email" name="driverEmail" ng-model="driver.email" placeholder="Email"></div>
				<div class="box-error">
					<small ng-show="form.driverEmail.$invalid">Enter a valid email.</small>
				</div>
			</li>

		</ul>

		<div ng-if="driver.login">  

			<h3 class="title">Access info</h3>

			<ul class="ul-inputs">

				<li class="li-input"> 
					<div class="label">Login:</div>
					<div class="input"><input type="text" name="driverLogin" readonly="readonly" disabled="disabled" ng-model="driver.login"></div>
				</li>

				<li class="li-input"> 
					<div class="label">Password:</div>
					<div class="input"><input type="password" name="driverPass" ng-model="driver.pass"></div>
					<small class="tip">Leave it blank if you don't wanna change it.</small>
				</li>

			</ul>

		</div>

	</form>

	<div ng-if="driver.id_admin">
		<h3 class="title">Documents</h3>
		<table class="tb-grid">
			<tbody>
				<tr ng-repeat="doc in documents">
					<td ng-click="edit(driver.id_admin)">
						{{doc.name}}
					</td>
					<td>
						<span ng-show="doc.status" title="Sent at {{doc.status.date_formated}}"><a href="{{doc.status.url}}" target="_blank">Download</a></span>
						<span ng-if="!doc.status" ng-click="setDocument(doc.id_driver_document)" class="sp-label sp-label-warning link">
							Document missing
						</span>
					</td>
				</tr>
			</tbody>
		</table>	
	</div>

	<form name="docs" ng-if="driver.id_admin">

		<h3 class="title">Upload zone</h3>	
		
		<ul class="ul-inputs">
			<li class="li-input"> 
				<div class="label">Select the file type:</div>
				<select name="driverDocument" ng-model="doc_uploaded" ng-change="setDocument( this.doc_uploaded )" ng-options="opt.id_driver_document as opt.name for opt in documents"></select>
			</li>
			<li ng-show="doc_uploaded">
				<input ng-file-select name="file" type="file" />
			</li>
			<li ng-show="uploader.progress"  class="li-input">
				<span class="sp-label sp-label-info">
					Progress {{uploader.progress}}%
				</span>
			</li>
			<li ng-show="doc_uploaded"  class="li-input">
				<button class="button" ng-click="uploader.uploadAll();">Upload</button>
			</li>
		</ul>

	</form>

	<ul class="ul-inputs">
		<li>
			<div class="label"><input type="checkbox" name="driverNotification" ng-model="driver.notify"> Send setup notification?</div>
		</li>

		<li class="li-input"> 
			<button class="button save" ng-click="save();">Save</button>
			<button class="button cancel" ng-click="cancel()">Cancel</button>
		</li>
	</ul>

</div>

<spinner-loading></spinner-loading>
<hack-expand-content></hack-expand-content>